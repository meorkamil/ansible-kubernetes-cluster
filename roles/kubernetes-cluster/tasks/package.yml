- name: Install containerd
  raw: dnf install containerd.io --allowerasing

- name: Install all Kubernetes packages
  yum:
    name: "{{ item.name }}"
    state: "{{ item.state }}"
    disable_excludes: kubernetes
  loop: "{{ kube_package }}"

- name: create containerd /etc/
  file:
    state: directory
    path: /etc/containerd

- name: Containerd setup
  raw: containerd config default > /etc/containerd/config.toml

- name: Start containerd and kubelet
  service:
    name: "{{ item }}"
    state: started
    enabled: yes
  loop: 
    - containerd
    - kubelet